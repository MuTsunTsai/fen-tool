(()=>{var t={pattern:void 0,bg:void 0,blackWhite:!1,knightOffset:.6,SN:!1,size:44,set:"1echecs"},e=[26,32,38,44],s=["1echecs","alpha","goodCompanion","merida","skak"];var n=/\/|\d|\(!?[kqbnrp]\d?\)|[-~]?(\*\d)?([kqbsnrpcx]|'[^']|''..)|./giu;var a="０１２３４５６７８９".split(""),r=function(){const t=new Map,e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ,./<>?;':\"[]\\{}|!@#$%^&*()_+-=`~".split(""),s="ａｂｃｄｅｆｇｈｉｊｋｌｍｎｏｐｑｒｓｔｕｖｗｘｙｚＡＢＣＤＥＦＧＨＩＪＫＬＭＮＯＰＱＲＳＴＵＶＷＸＹＺ，．／＜＞？；’：”〔〕＼｛｝｜！＠＃＄％︿＆＊（）ˍ＋－＝‘～".split("");for(let n=0;n<e.length;n++)t.set(e[n],s[n]);for(let e=0;e<10;e++)t.set(e.toString(),a[e]);return t}();var i=["k","q","b","n","r","p","c","x"];function o(t,e,s,n,a,o,c){const l=c.size,f=a.startsWith("-");f&&(a=a.substring(1));const h=a.match(/^\*(\d)/);let g=h&&h[1]||void 0;void 0!==g&&(a=a.substring(2)),g=Number(g)%4,"s"==a&&(a="n"),"S"==a&&(a="N");const u=a.toLowerCase(),b=i.indexOf(u),d=a.startsWith("'"),m="gray"==c.bg;if((b<0||m)&&2!=o&&function(t,e,s,n,a){const r=a.size;t.save(),"gray"==a.bg?t.fillStyle=n?"#fff":"#bbb":t.fillStyle=n?"#FFCE9E":"#D18B47";t.fillRect(s*r+1,e*r+1,r,r),t.restore()}(t,s,n,o,c),b<0&&!d)return;t.save(),m&&(o=2);const p=c.blackWhite,k=f?p?0:2:a==u?0:1,v=f&&p?"n"==u?c.knightOffset:.5:1,[x,w]=[g+1&2?1:0,2&g?1:0];if(t.translate((n+x)*l+1,(s+w)*l+1),0!==g&&t.rotate(Math.PI/2*g),d){const e=a.substring(1);!function(t,e,s){t.fillStyle="black";const n=t.measureText(e),a=n.actualBoundingBoxAscent-n.actualBoundingBoxDescent,r=Math.max((s-n.width)/2,0),i=Math.max((s-a)/2,0);t.fillText(e,r,s-i,s)}(t,a.startsWith("''")?a.substring(2):(z=e,((O=!1)&&"c"==z.toLowerCase()?"‧":O&&"x"==z.toLowerCase()?"╳":r.get(z))||e),l)}else t.drawImage(e,(k+3*o)*l,b*l,l*v,l,0,0,l*v,l),f&&p&&t.drawImage(e,(1+v+3*o)*l,b*l,l*(1-v),l,l*v,0,l*(1-v),l);var z,O;t.restore()}function c(t,e,s){if("mono"==t)return 1;let n=(e+s)%2;return"inverted"!=t&&(n=1-n),n}var l=document.getElementById("CN"),f=l.getContext("2d");var h=new URL(location.href),g=h.searchParams.get("fen")||"8/8/8/8/8/8/8/8",u=function(t){const e=t.match(n)||[],s=[];let a=!1;for(const t of e){if("/"==t){if(!a){const t=s.length+8-s.length%8;for(;s.length<t;)s.push("")}}else if(t.match(/^\d$/)){const e=Number(t);for(let t=0;t<e;t++)s.push("")}else s.push(t);a="/"!=t&&s.length%8==0}for(;s.length<64;)s.push("");return s}(g),b=function(n){const a=Object.assign({},t);if(n){const t=Number(n.size);e.includes(t)&&(a.size=t),s.includes(n.set)&&(a.set=n.set),0<n.knightOffset&&n.knightOffset<1&&(a.knightOffset=n.offset),a.blackWhite=Boolean(n.blackWhite),a.pattern=n.pattern,a.bg=n.bg,a.SN=n.SN}return a}({size:h.searchParams.get("size"),set:h.searchParams.get("set"),knightOffset:h.searchParams.get("knightOffset"),pattern:h.searchParams.get("pattern"),bg:h.searchParams.get("bg"),blackWhite:h.searchParams.has("blackWhite")}),d=new Image;d.onload=()=>{(function(t,e,s){const n=8*s.size+2;l.width=l.height=n,f.fillStyle="black",f.fillRect(0,0,n,n),f.font=s.size-4+"px arial";for(let n=0;n<8;n++)for(let a=0;a<8;a++){const r=c(s.pattern,n,a);o(f,t,n,a,e[8*n+a],r,s)}return l}(d,u,b)).title=g+"\n\nGenerated by https://mutsuntsai.github.io/fen-tool"},d.src=`../assets/${b.set}${b.size}.png`})();