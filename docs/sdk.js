(()=>{var t="[ðŸ‡¦-ðŸ‡¿]{2}|\\p{ExtPict}\\uFE0F?\\p{EMod}?(\\u200D\\p{ExtPict}\\uFE0F?\\p{EMod}?)*",e="\\((!?)([kqbnrp])(\\d?)\\)",n="'(".concat(t,"|[^'])|''.."),o="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat(n,")"),r=("^(?:".concat(t,")$"),"^(?:".concat(e,"|").concat(o,")$"),RegExp("\\/|\\d+|".concat(e,"|").concat(o,"|."),"iug"));var s={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:8,h:8,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},a=/^\d+(,\d+)*$/,c=[26,32,38,44],i=["1echecs","alpha","goodCompanion","merida","skak"];function d(t){const e=Object.assign({},s);if(t){const o=Number(t.size);c.includes(o)&&(e.size=o),i.includes(t.set)&&(e.set=t.set),t.border="string"!=typeof(n=t.border)?null:(n=n.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(a)?n:null,t.border&&(e.border=t.border),0<t.knightOffset&&t.knightOffset<1&&(e.knightOffset=t.offset),e.blackWhite=Boolean(t.blackWhite),e.pattern=t.pattern,e.bg=t.bg,e.SN=t.SN;const r=Math.floor(Number(t.w)),s=Math.floor(Number(t.h));r>0&&(e.w=r),s>0&&(e.h=s)}var n;return e}var u=20;function f(t,e){const n=function(t){const e=t.split(",").map((t=>{const e=Number(t);return isNaN(e)?0:Math.abs(Math.floor(e))})),n=e.reduce(((t,e)=>t+e),0);return{array:e,size:n}}(t.border),o=t.coordinates?{x:u,y:u}:{x:0,y:0};!0===e&&(o.y=0),!1===e&&(o.x=0);return{w:t.w*t.size+2*n.size+o.x,h:t.h*t.size+2*n.size+o.y,border:n,offset:{x:n.size+o.x,y:n.size},margin:o}}var l,h=document.currentScript,g=new URL("api/",h.src),b="img[fen]",m=document.createElement("iframe");function p(t){const e=new MessageChannel;e.port1.onmessage=e=>{t.src=e.data,t.title=l.getTitle(n,t.dataset)};const n=t.getAttribute("fen"),o=d(Object.assign({},l.getDefault(),t.dataset)),s=function(t){const e=t.match(r)||[],n=[0];let o=0;for(const t of e)"/"==t?n[++o]=0:t.match(/^\d+$/)?n[o]+=Number(t):n[o]++;const s=n.length;if(1==s)return;const a=n[0];for(const t of n)if(t!=a)return;return{w:a,h:s}}(n);s&&Object.assign(o,s);const{w:a,h:c}=f(o);t.width=a,t.height=c,m.contentWindow.postMessage({fen:n,options:o},"*",[e.port2])}function w(t){t instanceof Element&&(t.matches(b)?p(t):t.querySelectorAll(b).forEach((t=>p(t))))}m.style.display="none";var E=document.currentScript;!async function(t){l=t,document.head.appendChild(m),await new Promise((t=>{const e=n=>{n.source==m.contentWindow&&(removeEventListener("message",e),t())};addEventListener("message",e),m.src=g.toString()}));const e=document.documentElement;new MutationObserver((t=>{for(const e of t)if("attributes"==e.type){const t=e.attributeName.toLowerCase(),n=t.startsWith("data");e.target==h&&n&&w(document),"IMG"!=e.target.nodeName||"fen"!=t&&!n||p(e.target)}else for(const t of e.addedNodes)w(t)})).observe(e,{childList:!0,attributes:!0,subtree:!0}),w(e)}({getDefault:()=>E.dataset,getTitle:t=>t+"\n\nGenerated by https://mutsuntsai.github.io/fen-tool"})})();