(()=>{var t="\\p{ExtPict}\\uFE0F?\\p{EMod}?(\\u200D\\p{ExtPict}\\uFE0F?\\p{EMod}?)*",e="\\((!?)([kqbnrp])(\\d?)\\)",n=`[-~]?(\\*\\d)?([kqbnrpcxstadg]|${`'(${t}|[^'])|''..`})`,o=new RegExp(`\\/|\\d+|${e}|${n}|.`,"iug");var s={pattern:void 0,bg:void 0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:8,h:8,set:"1echecs"},r=/^\d+(,\d+)*$/,a=[26,32,38,44],i=["1echecs","alpha","goodCompanion","merida","skak"];var c=document.currentScript,d=new URL("api/",c.src),u=c.dataset,f="img[fen]",h=document.createElement("iframe");function b(t){const e=new MessageChannel;e.port1.onmessage=e=>{t.src=e.data,t.title=n+"\n\nGenerated by https://mutsuntsai.github.io/fen-tool"};const n=t.getAttribute("fen"),c=function(t){const e=Object.assign({},s);if(t){const n=Number(t.size),o=Math.floor(Number(t.w)),s=Math.floor(Number(t.h));a.includes(n)&&(e.size=n),i.includes(t.set)&&(e.set=t.set),t.border&&t.border.match(r)&&(e.border=t.border),0<t.knightOffset&&t.knightOffset<1&&(e.knightOffset=t.offset),e.blackWhite=Boolean(t.blackWhite),e.pattern=t.pattern,e.bg=t.bg,e.SN=t.SN,o>0&&(e.w=o),s>0&&(e.h=s)}return e}(Object.assign({},u,t.dataset)),d=function(t){const e=t.split(",").map((t=>{const e=Number(t);return isNaN(e)?0:Math.abs(Math.floor(e))})),n=e.reduce(((t,e)=>t+e),0);return{array:e,size:n}}(c.border).size,{w:f,h:b}=function(t){const e=t.match(o)||[],n=[0];let s=0;for(const t of e)"/"==t?n[++s]=0:t.match(/^\d+$/)?n[s]+=Number(t):n[s]++;const r=n.length;if(1==r)return;const a=n[0];for(const t of n)if(t!=a)return;return{w:a,h:r}}(n)||c;t.width=c.size*f+2*d,t.height=c.size*b+2*d,h.contentWindow.postMessage({fen:n,options:c},"*",[e.port2])}function m(t){t.matches(f)?b(t):t.querySelectorAll(f).forEach((t=>b(t)))}h.style.display="none",async function(){document.head.appendChild(h),await new Promise((t=>{const e=n=>{n.source==h.contentWindow&&(removeEventListener("message",e),t())};addEventListener("message",e),h.src=d.toString()}));const t=document.documentElement;new MutationObserver((t=>{for(const e of t)if("attributes"==e.type){const t=e.attributeName.toLowerCase(),n=t.startsWith("data");e.target==c&&n&&m(document),"IMG"!=e.target.nodeName||"fen"!=t&&!n||b(e.target)}else for(const t of e.addedNodes)m(t)})).observe(t,{childList:!0,attributes:!0,subtree:!0}),m(t)}()})();