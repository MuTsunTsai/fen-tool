"use strict";(()=>{var e="".concat("[\\uD83C][\\uDDE6-\\uDDFF][\\uD83C][\\uDDE6-\\uDDFF]","|\\p{Extended_Pictographic}\\uFE0F?\\p{Emoji_Modifier}?(\\u200D\\p{Extended_Pictographic}\\uFE0F?\\p{Emoji_Modifier}?)*"),t="\\((!?)([kqbnrp])(\\d?)\\)",n="'(".concat(e,"|[^'])|''.."),o="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat(n,")"),r=("^(?:".concat(e,")$"),"^(?:".concat(t,"|").concat(o,")$"),RegExp("\\/|\\d+|".concat(t,"|").concat(o,"|."),"iug"));var s={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:8,h:8,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},c=/^\d+(,\d+)*$/,a=[26,32,38,44],i=["1echecs","alpha","goodCompanion","kilfiger","merida","mpchess","skak"];function d(e){const t=Object.assign({},s);if(e){const n=Number(e.size);a.includes(n)&&(t.size=n),e.set&&i.includes(e.set)&&(t.set=e.set),e.border=function(e){if("string"==typeof e&&(e=e.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(c))return e}(e.border),e.border&&(t.border=e.border),e.knightOffset&&0<e.knightOffset&&e.knightOffset<1&&(t.knightOffset=e.knightOffset),t.blackWhite=Boolean(e.blackWhite),t.pattern=e.pattern,t.bg=e.bg,t.SN=e.SN||!1;const o=Math.floor(Number(e.w)),r=Math.floor(Number(e.h));o>0&&(t.w=o),r>0&&(t.h=r)}return t}var u=20;function f(e,t){const n=function(e){const t=e.split(",").map((e=>{const t=Number(e);return isNaN(t)?0:Math.abs(Math.floor(t))})),n=t.reduce(((e,t)=>e+t),0);return{array:t,size:n}}(e.border),o=e.coordinates?{x:u,y:u}:{x:0,y:0};!0===t&&(o.y=0),!1===t&&(o.x=0);return{w:e.w*e.size+2*n.size+o.x,h:e.h*e.size+2*n.size+o.y,border:n,offset:{x:n.size+o.x,y:n.size},margin:o}}var h,g=document.currentScript,l="img[fen]",m=document.createElement("iframe");function b(e){const t=new MessageChannel;t.port1.onmessage=t=>{e.src=t.data,e.title=h.getTitle(n,e.dataset)};const n=e.getAttribute("fen"),o=d(Object.assign({},h.getDefault(),e.dataset)),s=function(e){const t=e.match(r)||[],n=[0];let o=0;for(const e of t)"/"==e?n[++o]=0:e.match(/^\d+$/)?n[o]+=Number(e):n[o]++;const s=n.length;if(1==s)return;const c=n[0];for(const e of n)if(e!=c)return;return{w:c,h:s}}(n);s&&Object.assign(o,s);const{w:c,h:a}=f(o);e.width=c,e.height=a,m.contentWindow.postMessage({fen:n,options:o},"*",[t.port2])}function p(e){e instanceof Element&&(e.matches(l)?b(e):e.querySelectorAll(l).forEach((e=>b(e))))}m.style.display="none";var w=document.currentScript;!async function(e){const t=new URL("api/",g.src);h=e,document.head.appendChild(m),await new Promise((e=>{const n=t=>{t.source==m.contentWindow&&(removeEventListener("message",n),e())};addEventListener("message",n),m.src=t.toString()}));const n=document.documentElement;new MutationObserver((e=>{for(const t of e)if("attributes"==t.type){const e=t.attributeName.toLowerCase(),n=e.startsWith("data");t.target==g&&n&&p(document.body),"IMG"!=t.target.nodeName||"fen"!=e&&!n||b(t.target)}else for(const e of t.addedNodes)p(e)})).observe(n,{childList:!0,attributes:!0,subtree:!0}),p(n)}({getDefault:()=>w.dataset,getTitle:e=>e+"\n\nGenerated by https://mutsuntsai.github.io/fen-tool"})})();