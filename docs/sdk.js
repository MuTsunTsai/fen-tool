"use strict";(()=>{var t="\\p{Extended_Pictographic}",e="\\p{Emoji_Modifier}",n="".concat("\\p{Regional_Indicator}","{2}|").concat(t,"\\uFE0F?").concat(e,"?(\\u200D").concat(t,"\\uFE0F?").concat(e,"?)*"),o="\\((!?)([kqbnrp])(\\d?)\\)",c="'(".concat(n,"|[^'])|''.."),r="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat(c,")"),s=("^(?:".concat(n,")$"),"^(?:".concat(o,"|").concat(r,")$"),RegExp("\\/|\\d+|".concat(o,"|").concat(r,"|."),"iug"));var a={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:8,h:8,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},i=/^\d+(,\d+)*$/,d=[26,32,38,44],f=["1echecs","alpha","goodCompanion","kilfiger","merida","mpchess","skak"];function u(t){const e=Object.assign({},a);if(t){const n=Number(t.size);d.includes(n)&&(e.size=n),t.set&&f.includes(t.set)&&(e.set=t.set),t.border=function(t){if("string"==typeof t&&(t=t.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(i))return t}(t.border),t.border&&(e.border=t.border),t.knightOffset&&0<t.knightOffset&&t.knightOffset<1&&(e.knightOffset=t.knightOffset),e.blackWhite=Boolean(t.blackWhite),e.pattern=t.pattern,e.bg=t.bg,e.SN=t.SN||!1;const o=Math.floor(Number(t.w)),c=Math.floor(Number(t.h));o>0&&(e.w=o),c>0&&(e.h=c)}return e}var g=20;function h(t,e){const n=function(t){const e=t.split(",").map((t=>{const e=Number(t);return isNaN(e)?0:Math.abs(Math.floor(e))})),n=e.reduce(((t,e)=>t+e),0);return{array:e,size:n}}(t.border),o=t.coordinates?{x:g,y:g}:{x:0,y:0};!0===e&&(o.y=0),!1===e&&(o.x=0);return{w:t.w*t.size+2*n.size+o.x,h:t.h*t.size+2*n.size+o.y,border:n,offset:{x:n.size+o.x,y:n.size},margin:o}}var l,b=document.currentScript,m="img[fen]",p=document.createElement("iframe");function w(t){const e=new MessageChannel;e.port1.onmessage=e=>{t.src=e.data,t.title=l.getTitle(n,t.dataset)};const n=t.getAttribute("fen"),o=u(Object.assign({},l.getDefault(),t.dataset)),c=function(t){const e=t.match(s)||[],n=[0];let o=0;for(const t of e)"/"==t?n[++o]=0:t.match(/^\d+$/)?n[o]+=Number(t):n[o]++;const c=n.length;if(1==c)return;const r=n[0];for(const t of n)if(t!=r)return;return{w:r,h:c}}(n);c&&Object.assign(o,c);const{w:r,h:a}=h(o);t.width=r,t.height=a,p.contentWindow.postMessage({fen:n,options:o},"*",[e.port2])}function k(t){t instanceof Element&&(t.matches(m)?w(t):t.querySelectorAll(m).forEach((t=>w(t))))}p.style.display="none";var y=document.currentScript;!async function(t){const e=new URL("api/",b.src);l=t,document.head.appendChild(p),await new Promise((t=>{const n=e=>{e.source==p.contentWindow&&(removeEventListener("message",n),t())};addEventListener("message",n),p.src=e.toString()}));const n=document.documentElement;new MutationObserver((t=>{for(const e of t)if("attributes"==e.type){const t=e.attributeName.toLowerCase(),n=t.startsWith("data");e.target==b&&n&&k(document.body),"IMG"!=e.target.nodeName||"fen"!=t&&!n||w(e.target)}else for(const t of e.addedNodes)k(t)})).observe(n,{childList:!0,attributes:!0,subtree:!0}),k(n)}({getDefault:()=>y.dataset,getTitle:t=>t+"\n\nGenerated by https://mutsuntsai.github.io/fen-tool"})})();