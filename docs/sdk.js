"use strict";(()=>{var t="[ðŸ‡¦-ðŸ‡¿]{2}|\\p{ExtPict}\\uFE0F?\\p{EMod}?(\\u200D\\p{ExtPict}\\uFE0F?\\p{EMod}?)*",e="\\((!?)([kqbnrp])(\\d?)\\)",n="'(".concat(t,"|[^'])|''.."),o="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat(n,")"),s=("^(?:".concat(t,")$"),"^(?:".concat(e,"|").concat(o,")$"),RegExp("\\/|\\d+|".concat(e,"|").concat(o,"|."),"iug"));var r={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:8,h:8,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},c=/^\d+(,\d+)*$/,a=[26,32,38,44],i=["1echecs","alpha","goodCompanion","kilfiger","merida","mpchess","skak"];function d(t){const e=Object.assign({},r);if(t){const n=Number(t.size);a.includes(n)&&(e.size=n),t.set&&i.includes(t.set)&&(e.set=t.set),t.border=function(t){if("string"==typeof t&&(t=t.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(c))return t}(t.border),t.border&&(e.border=t.border),t.knightOffset&&0<t.knightOffset&&t.knightOffset<1&&(e.knightOffset=t.knightOffset),e.blackWhite=Boolean(t.blackWhite),e.pattern=t.pattern,e.bg=t.bg,e.SN=t.SN||!1;const o=Math.floor(Number(t.w)),s=Math.floor(Number(t.h));o>0&&(e.w=o),s>0&&(e.h=s)}return e}var u=20;function f(t,e){const n=function(t){const e=t.split(",").map((t=>{const e=Number(t);return isNaN(e)?0:Math.abs(Math.floor(e))})),n=e.reduce(((t,e)=>t+e),0);return{array:e,size:n}}(t.border),o=t.coordinates?{x:u,y:u}:{x:0,y:0};!0===e&&(o.y=0),!1===e&&(o.x=0);return{w:t.w*t.size+2*n.size+o.x,h:t.h*t.size+2*n.size+o.y,border:n,offset:{x:n.size+o.x,y:n.size},margin:o}}var h,g=document.currentScript,l="img[fen]",b=document.createElement("iframe");function m(t){const e=new MessageChannel;e.port1.onmessage=e=>{t.src=e.data,t.title=h.getTitle(n,t.dataset)};const n=t.getAttribute("fen"),o=d(Object.assign({},h.getDefault(),t.dataset)),r=function(t){const e=t.match(s)||[],n=[0];let o=0;for(const t of e)"/"==t?n[++o]=0:t.match(/^\d+$/)?n[o]+=Number(t):n[o]++;const r=n.length;if(1==r)return;const c=n[0];for(const t of n)if(t!=c)return;return{w:c,h:r}}(n);r&&Object.assign(o,r);const{w:c,h:a}=f(o);t.width=c,t.height=a,b.contentWindow.postMessage({fen:n,options:o},"*",[e.port2])}function p(t){t instanceof Element&&(t.matches(l)?m(t):t.querySelectorAll(l).forEach((t=>m(t))))}b.style.display="none";var w=document.currentScript;!async function(t){const e=new URL("api/",g.src);h=t,document.head.appendChild(b),await new Promise((t=>{const n=e=>{e.source==b.contentWindow&&(removeEventListener("message",n),t())};addEventListener("message",n),b.src=e.toString()}));const n=document.documentElement;new MutationObserver((t=>{for(const e of t)if("attributes"==e.type){const t=e.attributeName.toLowerCase(),n=t.startsWith("data");e.target==g&&n&&p(document.body),"IMG"!=e.target.nodeName||"fen"!=t&&!n||m(e.target)}else for(const t of e.addedNodes)p(t)})).observe(n,{childList:!0,attributes:!0,subtree:!0}),p(n)}({getDefault:()=>w.dataset,getTitle:t=>t+"\n\nGenerated by https://mutsuntsai.github.io/fen-tool"})})();