"use strict";(self.webpackChunkfen_tool=self.webpackChunkfen_tool||[]).push([["557"],{5981:function(t,e,n){n.d(e,{i:()=>E,u:()=>k});var r,i=n("1019"),o=n("737"),l=n("2506");function a(){let t=document.createElement("canvas");return[t,t.getContext("2d")]}let c={26:"YdVh1QDVYdVh",32:"AAAKAAAAo/+jAAr/AP8KAKP/owAAAAoAAA==",38:"AAw+DAAM3P/cDD7/AP8+DNz/3AwADD4MAA==",44:"AC9yLwAv+f/5L3L/AP9yL/n/+S8AL3IvAA==",52:"A3i2eAN4////eLb/AP+2eP///3gDeLZ4Aw==",64:"AAAEHgQAAAA/5v/mPwAE5v///+YEHv//AP//HgTm////5gQAP+b/5j8AAAAEHgQAAA==",76:"AARZhFkEAAS7////uwRZ//////9ZhP//AP//hFn//////1kEu////7sEAARZhFkEAA==",88:"AEfE68RHAEf8/////EfE///////E6///AP//68T//////8RH/P////xHAEfE68RHAA=="},s={},[f,u]=a(),[h,d]=a();var g=n("6919");var A=((r={})[r.r90=1]="r90",r[r.r180=2]="r180",r[r.r270=3]="r270",r[r.full=4]="full",r);let m=["k","q","b","n","r","p","c","x","s","t","a","d"],[p,b]=a();function w(t,e){let{dpr:n}=e,{w:r,h:i,offset:o}=e.info;t.canvas.width=r*n,t.canvas.height=i*n,t.save(),t.scale(n,n),t.translate(o.x,o.y)}let x=document.getElementById("CN"),v=x.getContext("2d"),k=Math.min(2,Math.floor(devicePixelRatio));function E(t,e){let{w:n,h:r}=(0,o.t_)(e);return x.width=n*k,x.height=r*k,x.style.width=n+"px",x.style.height=r+"px",!function(t,e,n,r,a,x){let v=(0,o.t_)(n,void 0),k={info:v,assets:(0,i.N)(n,r),options:n,dpr:r},E="classic"==n.bg;w(t,k),function(t,e){let{w:n,h:r}=e;for(let i=0;i<r;i++)for(let r=0;r<n;r++)(function(t,e,n,r){let i=function(t,e,n){if("mono"==t)return 1;let r=(e+n)%2;return"inverted"!=t&&(r=1-r),r}(r.pattern,e,n),o=r.size;t.save(),t.translate(n*o,e*o),"classic"==r.bg?!function(t,e,n){if(t.strokeStyle="black",t.lineWidth=e/60,t.fillStyle="#fff",t.fillRect(0,0,e,e),n)return;t.beginPath();let r=e/7.5;for(let n=0;n<e;n+=r)t.moveTo(e-n,0),t.lineTo(0,e-n),n>0&&(t.moveTo(n,e),t.lineTo(e,n));t.stroke()}(t,o,i):(t.fillStyle=function(t,e){if("classic"==e)return"none";if("gray"==e)return t?"#fff":"#bbb";if("green"==e)return t?"#EEEED2":"#769656";else return t?"#FFCE9E":"#D18B47"}(i,r.bg),t.fillRect(0,0,o,o)),t.restore()})(t,i,r,e)}(t,n),t.restore(),w(b,k),function(t,e){let{w:n,h:r}=e.options;for(let i=0;i<r;i++)for(let r=0;r<n;r++)!function(t,e,n,r,i){let{assets:o,options:l,dpr:a}=i,c=function(t,e){void 0===t&&(t="");let n=!!t&&t.startsWith("-");n&&(t=t.substring(1));let r=t.match(/^\*(\d)/),i=r&&r[1]?Number(r[1]):void 0;void 0!==i&&(t=t.substring(2)),i=Number(i)%A.full,e.SN&&(t=(0,g.hv)(t,!1,!0));let o=t.toLowerCase(),l=m.indexOf(o),a=t.startsWith("'");return l<0&&!a?null:{neutral:n,rotate:i,isText:a,value:t,lower:o,typeIndex:l}}(r,l);if(!c)return;let{neutral:s,rotate:f,isText:u,value:h,lower:d,typeIndex:p}=c;t.save();let b=l.blackWhite,w=function(t,e){let{neutral:n,value:r,lower:i}=t;return n?e?0:2:r==i?0:1}(c,b),x=function(t,e,n,r){return t&&n?"n"==e?r.knightOffset:.5:1}(s,d,b,l),[v,k]=[f+1&2?1:0,2&f?1:0],{size:E}=l;t.translate((n+v)*E,(e+k)*E),0!==f&&t.rotate(Math.PI/2*f),u?function(t,e,n){var r;t.save();let i=g.Nv.test(e),o=n-4;t.font="".concat(o,"px sans-serif");let l=n-2,a=t.measureText(e);if(i&&a.width>l){let n=l/a.width;t.font="".concat(o*n,"px sans-serif"),a=t.measureText(e)}let c=(r=i?t.measureText("M"):a).actualBoundingBoxAscent-r.actualBoundingBoxDescent,s=(n-Math.min(a.width,l))/2,f=Math.max((n-c)/2,0);t.fillStyle="black",t.fillText(e,s,n-f,l),t.restore()}(t,h.substring(h.startsWith("''")?2:1),E):(t.drawImage(o,w*E*a,p*E*a,E*x*a,E*a,0,0,E*x,E),s&&b&&t.drawImage(o,(1+x)*E*a,p*E*a,E*(1-x)*a,E*a,E*x,0,E*(1-x),E)),t.restore()}(b,i,r,t[i*n+r],e)}(e,k),b.restore(),E&&!a&&!function(t,e,n){let{dpr:r,options:i}=n;(function(t,e,n){h.width=f.width=t.width,h.height=f.height=t.height,u.fillStyle="white",u.fillRect(0,0,t.width,t.height),u.globalCompositeOperation="destination-in",u.drawImage(t,0,0);let r=function(t){if(!(t in s)){let e=atob(c[t]),n=[];for(let t=0;t<e.length;t++)n.push(e.charCodeAt(t));s[t]=n}return s[t]}(e*n),i=Math.sqrt(r.length),o=(i-1)/2;for(let t=0;t<i;t++)for(let e=0;e<i;e++){let n=r[e*i+t];0!=n&&(u.globalAlpha=n/255,d.drawImage(f,t-o,e-o))}})(e,i.size,r),t.drawImage(h,0,0),t.drawImage(h,0,0),t.drawImage(h,0,0)}(t,p,k),t.drawImage(p,0,0),t.scale(r,r);let{w:y,h:N,offset:S,border:D,margin:P}=v;void 0===x&&n.coordinates&&(t.save(),t.translate(S.x,S.y),function(t,e,n){let{size:r,w:i,h:a}=e;t.font="15px sans-serif",t.strokeStyle="black",t.lineWidth=2,t.fillStyle="white",t.lineJoin="round";for(let e=0;e<a;e++){let i=(e+1).toString(),l=t.measureText(i),c=r*(a-e)-r/2+5,s=(o.Cd-l.width)/2-o.Cd-n;t.strokeText(i,s,c),t.fillText(i,s,c)}for(let e=0;e<i&&e<26;e++){let i=String.fromCharCode(l.oh+e),c=t.measureText(i),s=r*a+o.Cd+n-5,f=r*e+(r-c.width)/2;t.strokeText(i,f,s),t.fillText(i,f,s)}}(t,n,D.size),t.restore()),!a&&function(t,e,n,r,i){t.save(),t.translate(i.x,0),n-=i.x,r-=i.y;let o=0;for(let i=0;i<e.array.length;i++){let l=e.array[i];if(t.strokeStyle=i%2?"white":"black",0==l)continue;t.lineWidth=l;let a=e.size-o-l/2;t.strokeRect(a,a,n-2*a,r-2*a),o+=l}t.restore()}(t,D,y,N,P)}(v,t,e,k),x}},2506:function(t,e,n){n.d(e,{Dm:function(){return r},_N:function(){return i},oh:function(){return o}});let r=8,i=3,o=97},6919:function(t,e,n){n.d(e,{A1:function(){return u},Nv:function(){return s},S3:function(){return h},hv:function(){return d}});var r=n(2506);let i="\\p{Extended_Pictographic}",o="\\p{Emoji_Modifier}",l="".concat("\\p{Regional_Indicator}","{2}|").concat(i,"\\uFE0F?").concat(o,"?(\\u200D").concat(i,"\\uFE0F?").concat(o,"?)*"),a="\\((!?)([kqbnrp])(\\d?)\\)",c="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat("'(".concat(l,"|[^'])|''.."),")"),s=RegExp("^(?:".concat(l,")$"),"u");RegExp("^(?:".concat(a,"|").concat(c,")$"),"iu");let f=RegExp("\\/|\\d+|".concat(a,"|").concat(c,"|."),"iug");function u(t){let e=t.match(f)||[],n=[0],r=0;for(let t of e)"/"==t?n[++r]=0:t.match(/^\d+$/)?n[r]+=Number(t):n[r]++;let i=n.length;if(1!=i){if(function(t){let e=t[0];for(let n=1;n<t.length;n++)if(t[n]!=e)return!1;return!0}(n))return{w:n[0],h:i}}}function h(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Dm,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Dm,i=t.match(f)||[],o=[],l=!1;for(let t of i){if("/"==t){if(!l){let t=o.length+e-o.length%e;for(;o.length<t;)o.push("")}}else if(t.match(/^\d+$/)){let e=Number(t);for(let t=0;t<e;t++)o.push("")}else o.push(t);if(l="/"!=t&&o.length%e==0,o.length==e*n)break}for(;o.length<e*n;)o.push("");return o}function d(t,e,n){return t.match(/^-?(\*\d)?[sng]$/i)?(e?(n&&(t=t.replace("s","g").replace("S","G")),t=t.replace("n","s").replace("N","S")):(n&&(t=t.replace("s","n").replace("S","N")),t=t.replace("g","s").replace("G","S")),t):t}},737:function(t,e,n){n.d(e,{Cd:function(){return s},D_:function(){return c},t_:function(){return f}});var r=n(2506);let i={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:r.Dm,h:r.Dm,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},o=/^\d+(,\d+)*$/,l=[26,32,38,44],a=["1echecs","alpha","goodCompanion","kilfiger","merida","mpchess","skak"];function c(t){let e=Object.assign({},i);if(t){let n=Number(t.size);l.includes(n)&&(e.size=n),t.set&&a.includes(t.set)&&(e.set=t.set),t.border=function(t){if("string"==typeof t){if((t=t.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(o))return t}}(t.border),t.border&&(e.border=t.border),t.knightOffset&&0<t.knightOffset&&t.knightOffset<1&&(e.knightOffset=t.knightOffset),e.blackWhite=!!t.blackWhite,e.pattern=t.pattern,e.bg=t.bg,e.SN=t.SN||!1;let r=Math.floor(Number(t.w)),i=Math.floor(Number(t.h));r>0&&(e.w=r),i>0&&(e.h=i)}return e}let s=20;function f(t,e){let n=function(t){let e=t.split(",").map(t=>{let e=Number(t);return isNaN(e)?0:Math.abs(Math.floor(e))}),n=e.reduce((t,e)=>t+e,0);return{array:e,size:n}}(t.border),r=t.coordinates?{x:s,y:s}:{x:0,y:0};!0===e&&(r.y=0),!1===e&&(r.x=0);let i=t.w*t.size+2*n.size+r.x,o=t.h*t.size+2*n.size+r.y,l={x:n.size+r.x,y:n.size};return{w:i,h:o,border:n,offset:l,margin:r}}},1019:function(t,e,n){n.d(e,{$:function(){return c},N:function(){return a}});var r=n(2506);let i=document.createElement("canvas"),o=i.getContext("2d"),l=new Map;function a(t,e){let n=t.set+t.size*e;return l.get(n)}async function c(t,e,n){let r=e.set+e.size*n;if(l.has(r))return l.get(r);let i=await s(t,e,n),o=await f(i);return l.set(r,o),o}async function s(t,e,n){let{set:l,size:a}=e;t+="/x"+n;let[c,s]=await Promise.all([f("".concat(t,"/").concat(l).concat(a,".png")),f("".concat(t,"/symbol").concat(a,".png"))]);return i.width=a*n*r._N,i.height=a*n*12,o.drawImage(c,0,0),o.drawImage(s,0,a*n*6),i.toDataURL()}function f(t){return new Promise((e,n)=>{let r=new Image;r.onload=()=>e(r),r.onerror=t=>n(t),r.src=t})}}}]);