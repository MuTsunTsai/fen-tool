"use strict";(self.webpackChunkfen_tool=self.webpackChunkfen_tool||[]).push([["654"],{112:function(e,t,n){n.d(t,{i:()=>E,u:()=>k});var r,i=n(3298),l=n(9898),o=n(4791);function a(){let e=document.createElement("canvas");return[e,e.getContext("2d")]}let s={26:"YdVh1QDVYdVh",32:"AAAKAAAAo/+jAAr/AP8KAKP/owAAAAoAAA==",38:"AAw+DAAM3P/cDD7/AP8+DNz/3AwADD4MAA==",44:"AC9yLwAv+f/5L3L/AP9yL/n/+S8AL3IvAA==",52:"A3i2eAN4////eLb/AP+2eP///3gDeLZ4Aw==",64:"AAAEHgQAAAA/5v/mPwAE5v///+YEHv//AP//HgTm////5gQAP+b/5j8AAAAEHgQAAA==",76:"AARZhFkEAAS7////uwRZ//////9ZhP//AP//hFn//////1kEu////7sEAARZhFkEAA==",88:"AEfE68RHAEf8/////EfE///////E6///AP//68T//////8RH/P////xHAEfE68RHAA=="},c={},[f,h]=a(),[u,d]=a();var g=n(5420),A=((r={})[r.r90=1]="r90",r[r.r180=2]="r180",r[r.r270=3]="r270",r[r.full=4]="full",r);let m=["k","q","b","n","r","p","c","x","s","t","a","d"],[p,b]=a();function w(e,t){let{dpr:n}=t,{w:r,h:i,offset:l}=t.info;e.canvas.width=r*n,e.canvas.height=i*n,e.save(),e.scale(n,n),e.translate(l.x,l.y)}let x=document.getElementById("CN"),v=x.getContext("2d"),k=Math.min(2,Math.floor(devicePixelRatio));function E(e,t){let{w:n,h:r}=(0,l.getDimensions)(t);return x.width=n*k,x.height=r*k,x.style.width=n+"px",x.style.height=r+"px",!function(e,t,n,r,a,x){let v=(0,l.getDimensions)(n,void 0),k={info:v,assets:(0,i.N)(n,r),options:n,dpr:r},E="classic"==n.bg;w(e,k),function(e,t){let{w:n,h:r}=t;for(let i=0;i<r;i++)for(let r=0;r<n;r++)!function(e,t,n,r){var i,l;let o=function(e,t,n){if("mono"==e)return 1;let r=(t+n)%2;return"inverted"!=e&&(r=1-r),r}(r.pattern,t,n),a=r.size;e.save(),e.translate(n*a,t*a),"classic"==r.bg?function(e,t,n){if(e.strokeStyle="black",e.lineWidth=t/60,e.fillStyle="#fff",e.fillRect(0,0,t,t),n)return;e.beginPath();let r=t/7.5;for(let n=0;n<t;n+=r)e.moveTo(t-n,0),e.lineTo(0,t-n),n>0&&(e.moveTo(n,t),e.lineTo(t,n));e.stroke()}(e,a,o):(i=o,e.fillStyle="classic"==(l=r.bg)?"none":"gray"==l?i?"#fff":"#bbb":"green"==l?i?"#EEEED2":"#769656":i?"#FFCE9E":"#D18B47",e.fillRect(0,0,a,a)),e.restore()}(e,i,r,t)}(e,n),e.restore(),w(b,k),function(e,t){let{w:n,h:r}=t.options;for(let i=0;i<r;i++)for(let r=0;r<n;r++)!function(e,t,n,r,i){var l,o,a,s;let{assets:c,options:f,dpr:h}=i,u=function(e,t){void 0===e&&(e="");let n=!!e&&e.startsWith("-");n&&(e=e.substring(1));let r=e.match(/^\*(\d)/),i=r&&r[1]?Number(r[1]):void 0;void 0!==i&&(e=e.substring(2)),i=Number(i)%A.full,t.SN&&(e=(0,g.hv)(e,!1,!0));let l=e.toLowerCase(),o=m.indexOf(l),a=e.startsWith("'");return o<0&&!a?null:{neutral:n,rotate:i,isText:a,value:e,lower:l,typeIndex:o}}(r,f);if(!u)return;let{neutral:d,rotate:p,isText:b,value:w,lower:x,typeIndex:v}=u;e.save();let k=f.blackWhite,E=function(e,t){let{neutral:n,value:r,lower:i}=e;return n?2*!t:+(r!=i)}(u,k),y=(l=d,o=x,a=k,s=f,l&&a?"n"==o?s.knightOffset:.5:1),[N,D]=[p+1&2?1:0,2&p?1:0],{size:S}=f;e.translate((n+N)*S,(t+D)*S),0!==p&&e.rotate(Math.PI/2*p),b?function(e,t,n){var r;e.save();let i=g.Nv.test(t),l=n-4;e.font="".concat(l,"px sans-serif");let o=n-2,a=e.measureText(t);if(i&&a.width>o){let n=o/a.width;e.font="".concat(l*n,"px sans-serif"),a=e.measureText(t)}let s=(r=i?e.measureText("M"):a).actualBoundingBoxAscent-r.actualBoundingBoxDescent,c=(n-Math.min(a.width,o))/2,f=Math.max((n-s)/2,0);e.fillStyle="black",e.fillText(t,c,n-f,o),e.restore()}(e,w.substring(w.startsWith("''")?2:1),S):(e.drawImage(c,E*S*h,v*S*h,S*y*h,S*h,0,0,S*y,S),d&&k&&e.drawImage(c,(1+y)*S*h,v*S*h,S*(1-y)*h,S*h,S*y,0,S*(1-y),S)),e.restore()}(b,i,r,e[i*n+r],t)}(t,k),b.restore(),E&&!0&&function(e,t,n){let{dpr:r,options:i}=n;(function(e,t,n){u.width=f.width=e.width,u.height=f.height=e.height,h.fillStyle="white",h.fillRect(0,0,e.width,e.height),h.globalCompositeOperation="destination-in",h.drawImage(e,0,0);let r=function(e){if(!(e in c)){let t=atob(s[e]),n=[];for(let e=0;e<t.length;e++)n.push(t.charCodeAt(e));c[e]=n}return c[e]}(t*n),i=Math.sqrt(r.length),l=(i-1)/2;for(let e=0;e<i;e++)for(let t=0;t<i;t++){let n=r[t*i+e];0!=n&&(h.globalAlpha=n/255,d.drawImage(f,e-l,t-l))}})(t,i.size,r),e.drawImage(u,0,0),e.drawImage(u,0,0),e.drawImage(u,0,0)}(e,p,k),e.drawImage(p,0,0),e.scale(r,r);let{w:y,h:N,offset:D,border:S,margin:P}=v;n.coordinates&&(e.save(),e.translate(D.x,D.y),function(e,t,n){let{size:r,w:i,h:a}=t;e.font="15px sans-serif",e.strokeStyle="black",e.lineWidth=2,e.fillStyle="white",e.lineJoin="round";for(let t=0;t<a;t++){let i=(t+1).toString(),o=e.measureText(i),s=r*(a-t)-r/2+5,c=(l.Cd-o.width)/2-l.Cd-n;e.strokeText(i,c,s),e.fillText(i,c,s)}for(let t=0;t<i&&t<26;t++){let i=String.fromCharCode(o.oh+t),s=e.measureText(i),c=r*a+l.Cd+n-5,f=r*t+(r-s.width)/2;e.strokeText(i,f,c),e.fillText(i,f,c)}}(e,n,S.size),e.restore()),a||function(e,t,n,r,i){e.save(),e.translate(i.x,0),n-=i.x,r-=i.y;let l=0;for(let i=0;i<t.array.length;i++){let o=t.array[i];if(e.strokeStyle=i%2?"white":"black",0==o)continue;e.lineWidth=o;let a=t.size-l-o/2;e.strokeRect(a,a,n-2*a,r-2*a),l+=o}e.restore()}(e,S,y,N,P)}(v,e,t,k),x}},4791:function(e,t,n){n.d(t,{Dm:()=>r,_N:()=>i,oh:()=>l});let r=8,i=3,l=97},5420:function(e,t,n){n.d(t,{A1:()=>h,Nv:()=>c,S3:()=>u,hv:()=>d});var r=n(4791);let i="\\p{Extended_Pictographic}",l="\\p{Emoji_Modifier}",o="".concat("\\p{Regional_Indicator}","{2}|").concat(i,"\\uFE0F?").concat(l,"?(\\u200D").concat(i,"\\uFE0F?").concat(l,"?)*"),a="\\((!?)([kqbnrp])(\\d?)\\)",s="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat("'(".concat(o,"|[^'])|''.."),")"),c=RegExp("^(?:".concat(o,")$"),"u");RegExp("^(?:".concat(a,"|").concat(s,")$"),"iu");let f=RegExp("\\/|\\d+|".concat(a,"|").concat(s,"|."),"iug");function h(e){let t=e.match(f)||[],n=[0],r=0;for(let e of t)"/"==e?n[++r]=0:e.match(/^\d+$/)?n[r]+=Number(e):n[r]++;let i=n.length;if(1!=i&&function(e){let t=e[0];for(let n=1;n<e.length;n++)if(e[n]!=t)return!1;return!0}(n))return{w:n[0],h:i}}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Dm,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Dm,i=e.match(f)||[],l=[],o=!1;for(let e of i){if("/"==e){if(!o){let e=l.length+t-l.length%t;for(;l.length<e;)l.push("")}}else if(e.match(/^\d+$/)){let t=Number(e);for(let e=0;e<t;e++)l.push("")}else l.push(e);if(o="/"!=e&&l.length%t==0,l.length==t*n)break}for(;l.length<t*n;)l.push("");return l}function d(e,t,n){return e.match(/^-?(\*\d)?[sng]$/i)&&(t?(n&&(e=e.replace("s","g").replace("S","G")),e=e.replace("n","s").replace("N","S")):(n&&(e=e.replace("s","n").replace("S","N")),e=e.replace("g","s").replace("G","S"))),e}},9898:function(e,t,n){n.d(t,{Cd:()=>c,D_:()=>s,getDimensions:()=>f});var r=n(4791);let i={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:r.Dm,h:r.Dm,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},l=/^\d+(,\d+)*$/,o=[26,32,38,44],a=["1echecs","alpha","goodCompanion","kilfiger","merida","mpchess","skak"];function s(e){let t=Object.assign({},i);if(e){let n=Number(e.size);o.includes(n)&&(t.size=n),e.set&&a.includes(e.set)&&(t.set=e.set),e.border=function(e){if("string"==typeof e&&(e=e.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(l))return e}(e.border),e.border&&(t.border=e.border),e.knightOffset&&0<e.knightOffset&&e.knightOffset<1&&(t.knightOffset=e.knightOffset),t.blackWhite=!!e.blackWhite,t.pattern=e.pattern,t.bg=e.bg,t.SN=e.SN||!1;let r=Math.floor(Number(e.w)),i=Math.floor(Number(e.h));r>0&&(t.w=r),i>0&&(t.h=i)}return t}let c=20;function f(e,t){let n=function(e){let t=e.split(",").map(e=>{let t=Number(e);return isNaN(t)?0:Math.abs(Math.floor(t))}),n=t.reduce((e,t)=>e+t,0);return{array:t,size:n}}(e.border),r=e.coordinates?{x:c,y:c}:{x:0,y:0};!0===t&&(r.y=0),!1===t&&(r.x=0);let i=e.w*e.size+2*n.size+r.x,l=e.h*e.size+2*n.size+r.y,o={x:n.size+r.x,y:n.size};return{w:i,h:l,border:n,offset:o,margin:r}}},3298:function(e,t,n){n.d(t,{$:()=>s,N:()=>a});var r=n(4791);let i=document.createElement("canvas"),l=i.getContext("2d"),o=new Map;function a(e,t){let n=e.set+e.size*t;return o.get(n)}async function s(e,t,n){let r=t.set+t.size*n;if(o.has(r))return o.get(r);let i=await c(e,t,n),l=await f(i);return o.set(r,l),l}async function c(e,t,n){let{set:o,size:a}=t;e+="/x"+n;let[s,c]=await Promise.all([f("".concat(e,"/").concat(o).concat(a,".png")),f("".concat(e,"/symbol").concat(a,".png"))]);return i.width=a*n*r._N,i.height=a*n*12,l.drawImage(s,0,0),l.drawImage(c,0,a*n*6),i.toDataURL()}function f(e){return new Promise((t,n)=>{let r=new Image;r.onload=()=>t(r),r.onerror=e=>n(e),r.src=e})}}}]);