"use strict";(self.webpackChunkfen_tool=self.webpackChunkfen_tool||[]).push([["137"],{3999:function(e,t,n){n.d(t,{i:()=>x,u:()=>b});var r,i=n("6919"),a=n("1019"),o=n("737"),l=n("2506");var c=((r={})[r.r90=1]="r90",r[r.r180=2]="r180",r[r.r270=3]="r270",r[r.full=4]="full",r);let s=["k","q","b","n","r","p","c","x","s","t","a","d"],f=document.createElement("canvas"),u=f.getContext("2d"),h=document.createElement("canvas"),d=h.getContext("2d"),g={26:"YdVh1QDVYdVh",32:"AAAKAAAAo/+jAAr/AP8KAKP/owAAAAoAAA==",38:"AAw+DAAM3P/cDD7/AP8+DNz/3AwADD4MAA==",44:"AC9yLwAv+f/5L3L/AP9yL/n/+S8AL3IvAA==",52:"A3i2eAN4////eLb/AP+2eP///3gDeLZ4Aw==",64:"AAAEHgQAAAA/5v/mPwAE5v///+YEHv//AP//HgTm////5gQAP+b/5j8AAAAEHgQAAA==",76:"AARZhFkEAAS7////uwRZ//////9ZhP//AP//hFn//////1kEu////7sEAARZhFkEAA==",88:"AEfE68RHAEf8/////EfE///////E6///AP//68T//////8RH/P////xHAEfE68RHAA=="},A={};function m(e,t,n,r){let i=function(e,t,n){if("mono"==e)return 1;let r=(t+n)%2;return"inverted"!=e&&(r=1-r),r}(r.pattern,t,n),a=r.size;e.save(),e.translate(n*a,t*a),"classic"==r.bg?(e.strokeStyle="black",e.lineWidth=a/60,e.fillStyle="#fff",e.fillRect(0,0,a,a),!i&&function(e,t){e.beginPath();let n=t/7.5;for(let r=0;r<t;r+=n)e.moveTo(t-r,0),e.lineTo(0,t-r),r>0&&(e.moveTo(r,t),e.lineTo(t,r));e.stroke()}(e,a)):(e.fillStyle=function(e,t){if("classic"==t)return"none";if("gray"==t)return e?"#fff":"#bbb";if("green"==t)return e?"#EEEED2":"#769656";else return e?"#FFCE9E":"#D18B47"}(i,r.bg),e.fillRect(0,0,a,a)),e.restore()}let p=document.getElementById("CN"),w=p.getContext("2d"),b=Math.min(2,Math.floor(devicePixelRatio));function x(e,t){let{w:n,h:r}=(0,o.t_)(t);return p.width=n*b,p.height=r*b,p.style.width=n+"px",p.style.height=r+"px",!function(e,t,n,r,p,w){let{w:b,h:x,border:v,offset:k,margin:E}=(0,o.t_)(n,void 0),y=(0,a.N)(n,r);e.canvas.width=b*r,e.canvas.height=x*r,e.save(),e.scale(r,r);let N="classic"==n.bg,S=N;e.translate(k.x,k.y);for(let a=0;a<n.h;a++)for(let o=0;o<n.w;o++)!S&&m(e,a,o,n),function(e,t,n,r,a){let{assets:o,options:l,dpr:f}=a,u=function(e,t){void 0===e&&(e="");let n=!!e&&e.startsWith("-");n&&(e=e.substring(1));let r=e.match(/^\*(\d)/),a=r&&r[1]?Number(r[1]):void 0;void 0!==a&&(e=e.substring(2)),a=Number(a)%c.full,t.SN&&(e=(0,i.hv)(e,!1,!0));let o=e.toLowerCase(),l=s.indexOf(o),f=e.startsWith("'");return l<0&&!f?null:{neutral:n,rotate:a,isText:f,value:e,lower:o,typeIndex:l}}(r,l);if(!u)return;let{neutral:h,rotate:d,isText:g,value:A,lower:m,typeIndex:p}=u;e.save();let w=l.blackWhite,b=function(e,t){let{neutral:n,value:r,lower:i}=e;return n?t?0:2:r==i?0:1}(u,w),x=function(e,t,n,r){return e&&n?"n"==t?r.knightOffset:.5:1}(h,m,w,l),[v,k]=[d+1&2?1:0,2&d?1:0],{size:E}=l;e.translate((n+v)*E,(t+k)*E),0!==d&&e.rotate(Math.PI/2*d),g?function(e,t,n){var r;e.save();let a=i.Nv.test(t),o=n-4;e.font="".concat(o,"px sans-serif");let l=n-2,c=e.measureText(t);if(a&&c.width>l){let n=l/c.width;e.font="".concat(o*n,"px sans-serif"),c=e.measureText(t)}let s=(r=a?e.measureText("M"):c).actualBoundingBoxAscent-r.actualBoundingBoxDescent,f=(n-Math.min(c.width,l))/2,u=Math.max((n-s)/2,0);e.fillStyle="black",e.fillText(t,f,n-u,l),e.restore()}(e,A.substring(A.startsWith("''")?2:1),E):(e.drawImage(o,b*E*f,p*E*f,E*x*f,E*f,0,0,E*x,E),h&&w&&e.drawImage(o,(1+x)*E*f,p*E*f,E*(1-x)*f,E*f,E*x,0,E*(1-x),E)),e.restore()}(e,a,o,t[a*n.w+o],{assets:y,options:n,dpr:r});if(e.restore(),N&&!p){(function(e,t,n){let r=e.canvas;h.width=f.width=r.width,h.height=f.height=r.height,u.drawImage(r,0,0),e.save(),e.fillStyle="white",e.fillRect(0,0,r.width,r.height),e.globalCompositeOperation="destination-in",e.drawImage(f,0,0),e.restore(),e.save();let i=function(e){if(!(e in A)){let t=atob(g[e]),n=[];for(let e=0;e<t.length;e++)n.push(t.charCodeAt(e));A[e]=n}return A[e]}(t*n),a=Math.sqrt(i.length),o=(a-1)/2;for(let t=0;t<a;t++)for(let n=0;n<a;n++){let l=i[n*a+t];0!=l&&(e.globalAlpha=l/255,d.drawImage(r,t-o,n-o))}e.restore()})(e,n.size,r),e.save(),e.scale(r,r),e.translate(k.x,k.y);for(let t=0;t<n.h;t++)for(let r=0;r<n.w;r++)m(e,t,r,n);e.restore(),e.drawImage(h,0,0),e.drawImage(h,0,0),e.drawImage(h,0,0),e.drawImage(f,0,0)}e.scale(r,r),void 0===w&&n.coordinates&&(e.save(),e.translate(k.x,k.y),function(e,t,n){let{size:r,w:i,h:a}=t;e.font="15px sans-serif",e.strokeStyle="black",e.lineWidth=2,e.fillStyle="white",e.lineJoin="round";for(let t=0;t<a;t++){let i=(t+1).toString(),l=e.measureText(i),c=r*(a-t)-r/2+5,s=(o.Cd-l.width)/2-o.Cd-n;e.strokeText(i,s,c),e.fillText(i,s,c)}for(let t=0;t<i&&t<26;t++){let i=String.fromCharCode(l.oh+t),c=e.measureText(i),s=r*a+o.Cd+n-5,f=r*t+(r-c.width)/2;e.strokeText(i,f,s),e.fillText(i,f,s)}}(e,n,v.size),e.restore()),!p&&function(e,t,n,r,i){e.save(),e.translate(i.x,0),n-=i.x,r-=i.y;let a=0;for(let i=0;i<t.array.length;i++){let o=t.array[i];if(e.strokeStyle=i%2?"white":"black",0==o)continue;e.lineWidth=o;let l=t.size-a-o/2;e.strokeRect(l,l,n-2*l,r-2*l),a+=o}e.restore()}(e,v,b,x,E)}(w,e,t,b),p}},2506:function(e,t,n){n.d(t,{Dm:function(){return r},_N:function(){return i},oh:function(){return a}});let r=8,i=3,a=97},6919:function(e,t,n){n.d(t,{A1:function(){return u},Nv:function(){return s},S3:function(){return h},hv:function(){return d}});var r=n(2506);let i="\\p{Extended_Pictographic}",a="\\p{Emoji_Modifier}",o="".concat("\\p{Regional_Indicator}","{2}|").concat(i,"\\uFE0F?").concat(a,"?(\\u200D").concat(i,"\\uFE0F?").concat(a,"?)*"),l="\\((!?)([kqbnrp])(\\d?)\\)",c="[-~]?(\\*\\d)?(".concat("[kqbnrpcxstadg]","|").concat("'(".concat(o,"|[^'])|''.."),")"),s=RegExp("^(?:".concat(o,")$"),"u");RegExp("^(?:".concat(l,"|").concat(c,")$"),"iu");let f=RegExp("\\/|\\d+|".concat(l,"|").concat(c,"|."),"iug");function u(e){let t=e.match(f)||[],n=[0],r=0;for(let e of t)"/"==e?n[++r]=0:e.match(/^\d+$/)?n[r]+=Number(e):n[r]++;let i=n.length;if(1!=i){if(function(e){let t=e[0];for(let n=1;n<e.length;n++)if(e[n]!=t)return!1;return!0}(n))return{w:n[0],h:i}}}function h(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.Dm,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.Dm,i=e.match(f)||[],a=[],o=!1;for(let e of i){if("/"==e){if(!o){let e=a.length+t-a.length%t;for(;a.length<e;)a.push("")}}else if(e.match(/^\d+$/)){let t=Number(e);for(let e=0;e<t;e++)a.push("")}else a.push(e);if(o="/"!=e&&a.length%t==0,a.length==t*n)break}for(;a.length<t*n;)a.push("");return a}function d(e,t,n){return e.match(/^-?(\*\d)?[sng]$/i)?(t?(n&&(e=e.replace("s","g").replace("S","G")),e=e.replace("n","s").replace("N","S")):(n&&(e=e.replace("s","n").replace("S","N")),e=e.replace("g","s").replace("G","S")),e):e}},737:function(e,t,n){n.d(t,{Cd:function(){return s},D_:function(){return c},t_:function(){return f}});var r=n(2506);let i={pattern:void 0,bg:void 0,exHigh:!0,border:"1",blackWhite:!1,knightOffset:.6,SN:!1,size:44,w:r.Dm,h:r.Dm,fullFEN:!1,coordinates:!1,set:"1echecs",collapse:!0},a=/^\d+(,\d+)*$/,o=[26,32,38,44],l=["1echecs","alpha","goodCompanion","kilfiger","merida","mpchess","skak"];function c(e){let t=Object.assign({},i);if(e){let n=Number(e.size);o.includes(n)&&(t.size=n),e.set&&l.includes(e.set)&&(t.set=e.set),e.border=function(e){if("string"==typeof e){if((e=e.replace(/\D/g,",").replace(/,+/g,",").replace(/^,/,"").replace(/,$/,"")).match(a))return e}}(e.border),e.border&&(t.border=e.border),e.knightOffset&&0<e.knightOffset&&e.knightOffset<1&&(t.knightOffset=e.knightOffset),t.blackWhite=!!e.blackWhite,t.pattern=e.pattern,t.bg=e.bg,t.SN=e.SN||!1;let r=Math.floor(Number(e.w)),i=Math.floor(Number(e.h));r>0&&(t.w=r),i>0&&(t.h=i)}return t}let s=20;function f(e,t){let n=function(e){let t=e.split(",").map(e=>{let t=Number(e);return isNaN(t)?0:Math.abs(Math.floor(t))}),n=t.reduce((e,t)=>e+t,0);return{array:t,size:n}}(e.border),r=e.coordinates?{x:s,y:s}:{x:0,y:0};!0===t&&(r.y=0),!1===t&&(r.x=0);let i=e.w*e.size+2*n.size+r.x,a=e.h*e.size+2*n.size+r.y,o={x:n.size+r.x,y:n.size};return{w:i,h:a,border:n,offset:o,margin:r}}},1019:function(e,t,n){n.d(t,{$:function(){return c},N:function(){return l}});var r=n(2506);let i=document.createElement("canvas"),a=i.getContext("2d"),o=new Map;function l(e,t){let n=e.set+e.size*t;return o.get(n)}async function c(e,t,n){let r=t.set+t.size*n;if(o.has(r))return o.get(r);let i=await s(e,t,n),a=await f(i);return o.set(r,a),a}async function s(e,t,n){let{set:o,size:l}=t;e+="/x"+n;let[c,s]=await Promise.all([f("".concat(e,"/").concat(o).concat(l,".png")),f("".concat(e,"/symbol").concat(l,".png"))]);return i.width=l*n*r._N,i.height=l*n*12,a.drawImage(c,0,0),a.drawImage(s,0,l*n*6),i.toDataURL()}function f(e){return new Promise((t,n)=>{let r=new Image;r.onload=()=>t(r),r.onerror=()=>n(),r.src=e})}}}]);